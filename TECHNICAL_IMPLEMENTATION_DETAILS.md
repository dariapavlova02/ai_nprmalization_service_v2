# üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è AI Service

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞

```
src/ai_service/
‚îú‚îÄ‚îÄ contracts/              # –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ base_contracts.py   # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ decision_contracts.py # –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
‚îú‚îÄ‚îÄ core/                   # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ unified_orchestrator.py # –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ decision_engine.py  # –î–≤–∏–∂–æ–∫ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ orchestrator_factory.py # –§–∞–±—Ä–∏–∫–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ layers/                 # 9-—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ validation/         # –°–ª–æ–π 1: –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ smart_filter/       # –°–ª–æ–π 2: –£–º–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
‚îÇ   ‚îú‚îÄ‚îÄ language/           # –°–ª–æ–π 3: –î–µ—Ç–µ–∫—Ü–∏—è —è–∑—ã–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ unicode/            # –°–ª–æ–π 4: Unicode –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ normalization/      # –°–ª–æ–π 5: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω
‚îÇ   ‚îú‚îÄ‚îÄ signals/            # –°–ª–æ–π 6: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ variants/           # –°–ª–æ–π 7: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ embeddings/         # –°–ª–æ–π 8: –≠–º–±–µ–¥–¥–∏–Ω–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ decision/           # –°–ª–æ–π 9: –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π
‚îú‚îÄ‚îÄ config/                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ settings.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ data/                   # –î–∞–Ω–Ω—ã–µ –∏ —Å–ª–æ–≤–∞—Ä–∏
‚îÇ   ‚îú‚îÄ‚îÄ dicts/              # –°–ª–æ–≤–∞—Ä–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ patterns/           # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞
‚îî‚îÄ‚îÄ utils/                  # –£—Ç–∏–ª–∏—Ç—ã
    ‚îú‚îÄ‚îÄ logging_config.py   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    ‚îî‚îÄ‚îÄ response_formatter.py # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
```

## üèóÔ∏è –ö–ª—é—á–µ–≤—ã–µ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. UnifiedOrchestrator (–ì–ª–∞–≤–Ω—ã–π –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö 9 —Å–ª–æ–µ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```python
async def process(
    text: str,
    generate_variants: bool = True,
    generate_embeddings: bool = False,
    remove_stop_words: bool = True,
    preserve_names: bool = True,
    enable_advanced_features: bool = True
) -> UnifiedProcessingResult
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 2. SmartFilterService (–£–º–Ω—ã–π –§–∏–ª—å—Ç—Ä)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞

**–î–µ—Ç–µ–∫—Ç–æ—Ä—ã**:
- `NameDetector` - –¥–µ—Ç–µ–∫—Ü–∏—è –∏–º–µ–Ω
- `CompanyDetector` - –¥–µ—Ç–µ–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π  
- `DocumentDetector` - –¥–µ—Ç–µ–∫—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `TerrorismDetector` - –¥–µ—Ç–µ–∫—Ü–∏—è —Ç–µ—Ä—Ä–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã**:
1. –ê–Ω–∞–ª–∏–∑ –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
2. –ü–æ–∏—Å–∫ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º
3. –î–µ—Ç–µ–∫—Ü–∏—è –¥–∞—Ç –∏ ID
4. –°–∫–æ—Ä–∏–Ω–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
5. –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ

### 3. NormalizationService (–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**:
- **PyMorphy3** - –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
- **SpaCy** - NLP –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **Custom rules** - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
2. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–æ–ª–µ–π —Ç–æ–∫–µ–Ω–æ–≤
3. –ú–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
4. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂
5. –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞

### 4. SignalsService (–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –°–∏–≥–Ω–∞–ª–æ–≤)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–≠–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä—ã**:
- `PersonExtractor` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω
- `OrganizationExtractor` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- `IdentifierExtractor` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ ID
- `BirthdateExtractor` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞—Ç —Ä–æ–∂–¥–µ–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
```python
@dataclass
class SignalsResult:
    persons: List[SignalsPerson]
    organizations: List[SignalsOrganization]
    extras: SignalsExtras
    confidence: float
```

### 5. DecisionEngine (–î–≤–∏–∂–æ–∫ –†–µ—à–µ–Ω–∏–π)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í–∑–≤–µ—à–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º —Å–∫–æ—Ä–∏–Ω–≥–∞**:
```python
score = (
    w_smartfilter * smartfilter_confidence +
    w_person * person_confidence +
    w_org * org_confidence +
    w_similarity * similarity_score +
    bonus_date_match * date_match +
    bonus_id_match * id_match
)
```

**–£—Ä–æ–≤–Ω–∏ —Ä–∏—Å–∫–∞**:
- **SKIP** (0.0-0.65): –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫
- **REVIEW** (0.65-0.85): –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫  
- **AUTO_HIT** (0.85-1.0): –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫

## üîÑ –ü–æ—Ç–æ–∫ –û–±—Ä–∞–±–æ—Ç–∫–∏ –î–∞–Ω–Ω—ã—Ö

### 1. –í—Ö–æ–¥–Ω—ã–µ –î–∞–Ω–Ω—ã–µ
```python
{
    "text": "–û–ø–ª–∞—Ç–∞ –¢–û–í '–ü–†–ò–í–ê–¢–ë–ê–ù–ö' –ò–≤–∞–Ω—É –ü–µ—Ç—Ä–æ–≤—É",
    "generate_variants": true,
    "generate_embeddings": false
}
```

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è (–°–ª–æ–π 1)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞

### 3. Smart Filter (–°–ª–æ–π 2)
```python
SmartFilterResult(
    should_process=True,
    confidence=0.75,
    classification="high_risk_organization",
    detected_signals=["company", "person", "payment"]
)
```

### 4. –î–µ—Ç–µ–∫—Ü–∏—è –Ø–∑—ã–∫–∞ (–°–ª–æ–π 3)
```python
{
    "language": "ru",
    "confidence": 0.95,
    "mixed_script": False
}
```

### 5. Unicode –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–°–ª–æ–π 4)
```python
"–û–ø–ª–∞—Ç–∞ –¢–û–í '–ü–†–ò–í–ê–¢–ë–ê–ù–ö' –ò–≤–∞–Ω—É –ü–µ—Ç—Ä–æ–≤—É" 
‚Üí "–û–ø–ª–∞—Ç–∞ –¢–û–í '–ü–†–ò–í–ê–¢–ë–ê–ù–ö' –ò–≤–∞–Ω—É –ü–µ—Ç—Ä–æ–≤—É"
```

### 6. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ò–º–µ–Ω (–°–ª–æ–π 5)
```python
NormalizationResult(
    normalized="–æ–ø–ª–∞—Ç–∞ —Ç–æ–≤ –ø—Ä–∏–≤–∞—Ç–±–∞–Ω–∫ –∏–≤–∞–Ω –ø–µ—Ç—Ä–æ–≤",
    tokens=["–æ–ø–ª–∞—Ç–∞", "—Ç–æ–≤", "–ø—Ä–∏–≤–∞—Ç–±–∞–Ω–∫", "–∏–≤–∞–Ω", "–ø–µ—Ç—Ä–æ–≤"],
    trace=[...]  # –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞
)
```

### 7. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –°–∏–≥–Ω–∞–ª–æ–≤ (–°–ª–æ–π 6)
```python
SignalsResult(
    persons=[
        SignalsPerson(
            core=["–∏–≤–∞–Ω", "–ø–µ—Ç—Ä–æ–≤"],
            full_name="–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
            confidence=0.85
        )
    ],
    organizations=[
        SignalsOrganization(
            core="–ø—Ä–∏–≤–∞—Ç–±–∞–Ω–∫",
            legal_form="–¢–û–í",
            full_name="–¢–û–í '–ü–†–ò–í–ê–¢–ë–ê–ù–ö'",
            confidence=0.90
        )
    ]
)
```

### 8. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –í–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–°–ª–æ–π 7, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```python
[
    "–æ–ø–ª–∞—Ç–∞ —Ç–æ–≤ –ø—Ä–∏–≤–∞—Ç–±–∞–Ω–∫ –∏–≤–∞–Ω –ø–µ—Ç—Ä–æ–≤",
    "–æ–ø–ª–∞—Ç–∞ —Ç–æ–≤ –ø—Ä–∏–≤–∞—Ç–±–∞–Ω–∫ –∏–≤–∞–Ω –ø–µ—Ç—Ä–æ–≤",
    "–æ–ø–ª–∞—Ç–∞ —Ç–æ–≤ –ø—Ä–∏–≤–∞—Ç–±–∞–Ω–∫ –∏–≤–∞–Ω –ø–µ—Ç—Ä–æ–≤"
]
```

### 9. –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ (–°–ª–æ–π 8, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```python
[0.123, -0.456, 0.789, ...]  # 384-–º–µ—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
```

### 10. –ü—Ä–∏–Ω—è—Ç–∏–µ –†–µ—à–µ–Ω–∏—è (–°–ª–æ–π 9)
```python
DecisionOutput(
    risk=RiskLevel.AUTO_HIT,
    score=0.87,
    reasons=["high_org_confidence", "valid_id_present"],
    details={...}
)
```

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **LRU Cache** —Å TTL
- **–ö–ª—é—á–∏ –∫—ç—à–∞**: MD5 —Ö–µ—à –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–†–∞–∑–º–µ—Ä –∫—ç—à–∞**: 10,000 –∑–∞–ø–∏—Å–µ–π
- **Hit rate**: 80%+

### 2. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –û–±—Ä–∞–±–æ—Ç–∫–∞
- **FastAPI** –¥–ª—è async HTTP
- **asyncio** –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **Batch processing** –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 3. –õ–µ–Ω–∏–≤–∞—è –ó–∞–≥—Ä—É–∑–∫–∞
- **–ú–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è** —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π** –≤ –ø–∞–º—è—Ç–∏
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã** –º–æ–¥–µ–ª–µ–π

### 4. –†–∞–Ω–Ω–µ–µ –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ
- **Smart Filter** –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–æ—Ä–æ–≥—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
- **–ü–æ—Ä–æ–≥–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏** –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- **–¢–∞–π–º–∞—É—Ç—ã** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```
tests/
‚îú‚îÄ‚îÄ unit/                   # Unit —Ç–µ—Å—Ç—ã (95%+ –ø–æ–∫—Ä—ã—Ç–∏–µ)
‚îÇ   ‚îú‚îÄ‚îÄ test_normalization.py
‚îÇ   ‚îú‚îÄ‚îÄ test_smart_filter.py
‚îÇ   ‚îî‚îÄ‚îÄ test_decision_engine.py
‚îú‚îÄ‚îÄ integration/            # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_pipeline_end2end.py
‚îÇ   ‚îî‚îÄ‚îÄ test_api_risk_response.py
‚îî‚îÄ‚îÄ e2e/                   # End-to-end —Ç–µ—Å—Ç—ã
    ‚îú‚îÄ‚îÄ test_full_pipeline_risk.py
    ‚îî‚îÄ‚îÄ test_sanctions_screening_pipeline.py
```

### –¢–∏–ø—ã –¢–µ—Å—Ç–æ–≤
- **Unit —Ç–µ—Å—Ç—ã**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Integration —Ç–µ—Å—Ç—ã**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–ª–æ–µ–≤
- **E2E —Ç–µ—Å—Ç—ã**: –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **Performance —Ç–µ—Å—Ç—ã**: –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Contract —Ç–µ—Å—Ç—ã**: –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ú–µ—Ç—Ä–∏–∫–∏

### Prometheus –ú–µ—Ç—Ä–∏–∫–∏
```python
# –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
ai_service_requests_total
ai_service_requests_successful_total
ai_service_processing_time_avg_seconds
ai_service_cache_hit_rate
ai_service_component_available
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏** (JSON)
- **–£—Ä–æ–≤–Ω–∏**: DEBUG, INFO, WARNING, ERROR
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** –≤ –∫–∞–∂–¥–æ–º –ª–æ–≥–µ
- **–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤** –ø–æ —Ä–∞–∑–º–µ—Ä—É –∏ –≤—Ä–µ–º–µ–Ω–∏

### Health Checks
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** (SpaCy –º–æ–¥–µ–ª–∏)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Environment Variables
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
APP_ENV=production
DEBUG=false
WORKERS=4

# Feature flags
ENABLE_SMART_FILTER=true
ENABLE_VARIANTS=false
ENABLE_EMBEDDINGS=false
ENABLE_DECISION_ENGINE=true

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
MAX_INPUT_LENGTH=10000
CACHE_SIZE=10000
CACHE_TTL=3600

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
ADMIN_API_KEY=your-secure-key
RATE_LIMIT_ENABLED=true
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ö–ª–∞—Å—Å—ã
```python
@dataclass
class ServiceConfig:
    max_input_length: int = 10000
    enable_smart_filter: bool = True
    enable_variants: bool = False
    enable_embeddings: bool = False
    enable_decision_engine: bool = True
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker
```dockerfile
FROM python:3.12-slim

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
COPY requirements.txt .
RUN pip install -r requirements.txt

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
COPY src/ /app/src/
WORKDIR /app

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
CMD ["uvicorn", "src.ai_service.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

### Docker Compose
```yaml
version: '3.8'
services:
  ai-service:
    build: .
    ports:
      - "8000:8000"
    environment:
      - APP_ENV=production
      - WORKERS=4
    volumes:
      - ./logs:/app/logs
```

### Kubernetes
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ai-service
spec:
  replicas: 3
  selector:
    matchLabels:
      app: ai-service
  template:
    spec:
      containers:
      - name: ai-service
        image: ai-service:latest
        ports:
        - containerPort: 8000
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
```

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Stateless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è
- **Load balancer** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏
- **Health checks** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- **Auto-scaling** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Memory optimization** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
- **CPU optimization** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è CPU
- **Caching strategies** - —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **Resource monitoring** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

---

*–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω: –î–∞—Ä—å—è –ü–∞–≤–ª–æ–≤–∞*  
*–î–∞—Ç–∞: –î–µ–∫–∞–±—Ä—å 2024*  
*–í–µ—Ä—Å–∏—è: 1.0*
