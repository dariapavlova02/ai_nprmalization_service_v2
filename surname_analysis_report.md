# Анализ влияния фамилий на сходство эмбеддингов

## Ключевые находки

### 1. **Фамилии СНИЖАЮТ межгрупповое сходство**

**Без фамилий:**
- Максимальное межгрупповое сходство: **92.40%** (Віка ↔ Дашенька)
- Среднее межгрупповое сходство: **58.04%**
- Стандартное отклонение: **0.1596** (высокий разброс)

**С фамилиями:**
- Максимальное межгрупповое сходство: **73.86%** (Вікторія Кухарук ↔ Даша Павлова)
- Среднее межгрупповое сходство: **60.58%**
- Стандартное отклонение: **0.0686** (низкий разброс)

### 2. **Фамилии ПОВЫШАЮТ внутригрупповое сходство**

**Группа Виктории:**
- Без фамилий: 62.71% ± 17.41%
- С фамилиями: 74.34% ± 11.83%
- **Улучшение: +11.62%**

**Группа Дарьи:**
- Без фамилий: 77.39% ± 11.14%
- С фамилиями: 89.09% ± 6.49%
- **Улучшение: +11.70%**

## Объяснение высокого сходства без фамилий

### 1. **Фонетическое сходство**
- "Вика" и "Даша" - оба короткие, двусложные имена
- Оба заканчиваются на "-а"
- Схожая ритмическая структура

### 2. **Семантическое сходство**
- Оба имени женские
- Оба являются сокращенными формами (Вика ← Виктория, Даша ← Дарья)
- Схожий "стиль" именования

### 3. **Лингвистические особенности**
- Модель может "видеть" общие паттерны в коротких именах
- Схожие морфологические характеристики
- Общие фонетические признаки

### 4. **Ограничения модели**
- Модель обучена на общих текстах, где имена часто встречаются в похожих контекстах
- Может "путать" короткие женские имена из-за схожих контекстов использования

## Практические выводы

### 1. **Для системы нормализации имен**

**Рекомендации:**
- **Использовать полные имена с фамилиями** для более точной идентификации
- **Добавить контекстную информацию** (отчество, фамилия) при сравнении имен
- **Установить более высокие пороги** для коротких имен без контекста

### 2. **Пороговые значения**

**Без фамилий:**
- Порог для группировки: **0.8+** (вместо 0.7+)
- Порог для уверенной идентификации: **0.9+**

**С фамилиями:**
- Порог для группировки: **0.7+** (как планировалось)
- Порог для уверенной идентификации: **0.8+**

### 3. **Специальная обработка**

**Короткие имена без контекста:**
- Требуют дополнительной проверки
- Рекомендуется использовать словари уменьшительных
- Добавлять контекстную информацию при возможности

## Технические рекомендации

### 1. **Архитектурные решения**
```python
# Псевдокод для улучшенной нормализации
def normalize_name_with_context(name, surname=None, patronymic=None):
    if surname:
        # Используем полное имя с фамилией для более точного сравнения
        return normalize_full_name(f"{name} {surname}")
    else:
        # Для коротких имен без контекста используем более строгие правила
        return normalize_short_name_with_strict_rules(name)
```

### 2. **Многоуровневая проверка**
1. **Уровень 1**: Сравнение с контекстом (фамилия, отчество)
2. **Уровень 2**: Сравнение без контекста с высоким порогом
3. **Уровень 3**: Словарная проверка уменьшительных форм

### 3. **Мониторинг качества**
- Отслеживать случаи ложных срабатываний для коротких имен
- Логировать случаи высокого сходства между разными именами
- Настраивать пороги на основе реальных данных

## Заключение

Высокое сходство между "Вика" и "Даша" объясняется:

1. **Фонетическим сходством** коротких женских имен
2. **Семантическим сходством** (оба сокращенные формы)
3. **Ограничениями модели** при работе с короткими именами без контекста

**Решение**: Использовать контекстную информацию (фамилии, отчества) и более строгие пороги для коротких имен без контекста.

Фамилии значительно улучшают качество группировки имен, делая систему более надежной и точной.
