# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–µ—Ä–µ–ø–æ–¥–Ω—è—Ç–∏—é AI Service —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–æ–∏—Å–∫–∞

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–∞—Å—Ç–∏—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** - —Ç–µ–ø–µ—Ä—å –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è "–ü–æ—Ä–æ—à–µ–Ω–∫–æ –ü–µ—Ç—Ä–æ" –∏ –ø–æ–¥–æ–±–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
2. **–ó–∞–≥—Ä—É–∂–µ–Ω–æ 942,282 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** –≤ Elasticsearch, –≤–∫–ª—é—á–∞—è 220,241 partial_match –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
3. **–ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** elasticsearch/httpx

## üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞: httpx dependency conflict

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π httpx/elasticsearch –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å

**–û—à–∏–±–∫–∞**:
```
AttributeError: module 'httpx' has no attribute '__version__'
```

## üìã –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ (Virtual Environment)

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv_ai_service
source venv_ai_service/bin/activate

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏
pip install httpx==0.25.2
pip install elasticsearch==8.10.0
pip install -r requirements.txt

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
ENABLE_SEARCH=true ENABLE_EMBEDDINGS=true \
uvicorn src.ai_service.main:app --host 0.0.0.0 --port 8000
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ requirements.txt

–î–æ–±–∞–≤–∏—Ç—å –≤ `requirements.txt`:
```txt
httpx==0.25.2
elasticsearch==8.10.0
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ó–∞–ø—É—Å–∫ –±–µ–∑ –ø–æ–∏—Å–∫–∞ (–≤—Ä–µ–º–µ–Ω–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å –±–µ–∑ –ø–æ–∏—Å–∫–∞:
```bash
ENABLE_SEARCH=false ENABLE_EMBEDDINGS=false \
uvicorn src.ai_service.main:app --host 0.0.0.0 --port 8000
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

```bash
curl -X POST http://localhost:8000/process \
  -H "Content-Type: application/json" \
  -d '{"text": "–ü–æ—Ä–æ—à–µ–Ω–∫–æ –ü–µ—Ç—Ä–æ –û–ª–µ–∫—Å—ñ–π–æ–≤–∏—á"}'
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∏—Å–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –∏–º–µ–Ω

```bash
curl -X POST http://localhost:8000/process \
  -H "Content-Type: application/json" \
  -d '{"text": "–ü–æ—Ä–æ—à–µ–Ω–∫–æ –ü–µ—Ç—Ä–æ"}' | jq .search_results
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω—ã —á–∞—Å—Ç–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å —Ç–∏–ø–æ–º `partial_match`.

### 3. –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Elasticsearch

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
python test_direct_es_search.py
```

## üìä –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------|----------|
| ‚úÖ –ß–∞—Å—Ç–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã | –†–∞–±–æ—Ç–∞–µ—Ç | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ |
| ‚úÖ Elasticsearch | –†–∞–±–æ—Ç–∞–µ—Ç | 942,282 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω—ã |
| ‚ùå AI Service | –ù–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è | httpx dependency conflict |
| ‚úÖ –ü–æ–∏—Å–∫ –≤ ES | –†–∞–±–æ—Ç–∞–µ—Ç | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞–ø—Ä—è–º—É—é |

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏:
```bash
python -c "import httpx; print(httpx.__version__)"
python -c "import elasticsearch; print('ES OK')"
```

2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å virtual environment:
```bash
python3 -m venv fresh_env
source fresh_env/bin/activate
pip install httpx==0.25.2 elasticsearch==8.10.0
```

### –ï—Å–ª–∏ –ø–æ–∏—Å–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
echo $ENABLE_SEARCH
echo $ENABLE_EMBEDDINGS
```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Elasticsearch:
```bash
curl 95.217.84.234:9200/_cluster/health
```

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:
```bash
curl 95.217.84.234:9200/ai_service_ac_patterns/_count
```

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞

1. **–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥**:
```bash
git pull origin main
```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ**:
```bash
python3 -m venv venv_ai_service
source venv_ai_service/bin/activate
pip install httpx==0.25.2 elasticsearch==8.10.0
pip install -r requirements.txt
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–æ–∏—Å–∫–æ–º**:
```bash
ENABLE_SEARCH=true ENABLE_EMBEDDINGS=true \
uvicorn src.ai_service.main:app --host 0.0.0.0 --port 8000
```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É**:
```bash
python test_direct_es_search.py
```

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- **–ü–∞—Ç—Ç–µ—Ä–Ω—ã —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã** - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- **–ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –ø—Ä–æ–±–ª–µ–º–∞ —Ç–æ–ª—å–∫–æ –≤ –∑–∞–ø—É—Å–∫–µ Python —Å–µ—Ä–≤–∏—Å–∞
- **Elasticsearch –¥–æ—Å—Ç—É–ø–µ–Ω** - 95.217.84.234:9200
- **942,282 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üÜò –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

–í—Ä–µ–º–µ–Ω–Ω—ã–π –æ–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å - –∑–∞–ø—É—Å–∫ –±–µ–∑ –ø–æ–∏—Å–∫–∞:
```bash
ENABLE_SEARCH=false uvicorn src.ai_service.main:app --host 0.0.0.0 --port 8000
```

–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, —Ç–æ–ª—å–∫–æ –±–µ–∑ AC/–≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞.