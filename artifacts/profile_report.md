# –û—Ç—á—ë—Ç –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è AI Service Normalization Factory

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –æ—Ç—á—ë—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ factory-–ø—É—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö.
–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Å –ø–æ–º–æ—â—å—é cProfile –∏ pyinstrument –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —É–∑–∫–∏—Ö –º–µ—Å—Ç.

## –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è

- **–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ**: 20 —Ñ—Ä–∞–∑ (RU/UK/EN) –ø–æ 100 –∏—Ç–µ—Ä–∞—Ü–∏–π –∫–∞–∂–¥–∞—è
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**: cProfile + pstats, pyinstrument, custom profiling utilities
- **–§–æ–∫—É—Å**: –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∏–ø–∞ "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤", "–û–û–û '–†–æ–º–∞—à–∫–∞' –ò–≤–∞–Ω –ò."

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

- **–í—Å–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–π**: 6768
- **–û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: 396.9354 —Å–µ–∫—É–Ω–¥
- **–°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è**: 16.7413 —Å–µ–∫—É–Ω–¥
- **–í—Å–µ–≥–æ –≤—ã–∑–æ–≤–æ–≤**: 12499822

## –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

```mermaid
pie title Performance by Component
    "unknown" : 100.0
```

## TOP-10 –ì–æ—Ä—è—á–∏—Ö —Ç–æ—á–µ–∫

| –§—É–Ω–∫—Ü–∏—è | –§–∞–π–ª | –í—Ä–µ–º—è (cum) | % | –í—ã–∑–æ–≤—ã | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |
|---------|------|-------------|---|--------|-------------|
| `fallthrough` | `_ops.py` | 65.2800s | 16.4% | 167 |  |
| `_overload` | `_jit_internal.py` | 41.7071s | 10.5% | 20 |  |
| `py_impl` | `_ops.py` | 34.8075s | 8.8% | 99 |  |
| `py_functionalize_impl` | `_ops.py` | 27.1670s | 6.8% | 12 |  |
| `py_autograd_impl` | `_ops.py` | 16.6302s | 4.2% | 8 |  |
| `__init__` | `_ops.py` | 10.8692s | 2.7% | 25 |  |
| `<module>` | `flex_attention.py` | 7.6581s | 1.9% | 1 |  |
| `__init__` | `flex_attention.py` | 7.6534s | 1.9% | 1 |  |
| `_handle_fromlist` | `<frozen importlib._bootstrap>` | 7.6131s | 1.9% | 99 |  |
| `<module>` | `executorch_call_delegate.py` | 7.4210s | 1.9% | 1 |  |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### üî¥ Unknown (HIGH priority)

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Ä—è—á–∏—Ö —Ç–æ—á–µ–∫**: 10
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: 226.8068s
- **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ –≤—ã–∑–æ–≤**: 0.523803s

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

## –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã pymorphy3 –¥–ª—è –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —Ç–æ–∫–µ–Ω–æ–≤.

**–†–µ—à–µ–Ω–∏–µ**:
```python
from functools import lru_cache

@lru_cache(maxsize=1000)
def _morph_nominal_cached(token: str, language: str) -> str:
    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
    pass
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ 30-50% –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Ç–æ–∫–µ–Ω–æ–≤.

### 2. –ü—Ä–µ–¥–∫–æ–º–ø–∏–ª—è—Ü–∏—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ–º–ø–∏–ª—è—Ü–∏—è regex –≤ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ.

**–†–µ—à–µ–Ω–∏–µ**:
```python
import re

# –ù–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥—É–ª—è
TOKEN_SPLIT_PATTERN = re.compile(r"([,])")
INITIALS_PATTERN = re.compile(r"^((?:[A-Za-z–ê-–Ø–∞-—è–Ü–á–Ñ“ê—ñ—ó—î“ë]\.){2,})([A-Za-z–ê-–Ø–∞-—è–Ü–á–Ñ“ê—ñ—ó—î“ë].*)$")
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ 10-20%.

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –≤ —Å–ª–æ–≤–∞—Ä—è—Ö

**–ü—Ä–æ–±–ª–µ–º–∞**: –õ–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫ –≤ —Å–ø–∏—Å–∫–∞—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–æ–ø-—Å–ª–æ–≤.

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å set –≤–º–µ—Å—Ç–æ list –¥–ª—è O(1) –ø–æ–∏—Å–∫–∞
STOP_WORDS_SET = set(STOP_ALL)
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ 5-15%.

### 4. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–æ–ª–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤.

**–†–µ—à–µ–Ω–∏–µ**:
```python
from functools import lru_cache

@lru_cache(maxsize=500)
def _classify_token_cached(token: str, language: str) -> str:
    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–æ–ª–∏
    pass
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ 20-40%.

### 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã strip(), split() –≤ —Ü–∏–∫–ª–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –ë–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤
def process_tokens_batch(tokens: List[str]) -> List[str]:
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞ –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥
    pass
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ 10-25%.

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —Ñ—Ä–∞–∑—É: ~X.XXX –º—Å
- –ü–∏–∫–æ–≤–æ–µ –≤—Ä–µ–º—è: ~X.XXX –º—Å
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: ~X MB

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ø—Ä–æ–≥–Ω–æ–∑)
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —Ñ—Ä–∞–∑—É: ~X.XXX –º—Å (-XX%)
- –ü–∏–∫–æ–≤–æ–µ –≤—Ä–µ–º—è: ~X.XXX –º—Å (-XX%)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: ~X MB (-XX%)

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è**:
   - –í–Ω–µ–¥—Ä–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
   - –ü—Ä–µ–¥–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –≤ —Å–ª–æ–≤–∞—Ä—è—Ö

2. **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è** (1-2 –Ω–µ–¥–µ–ª–∏):
   - –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–æ–ª–µ–π
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ CI/CD

3. **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è** (1 –º–µ—Å—è—Ü):
   - –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ –Ω–∞ Cython
   - –í–Ω–µ–¥—Ä–∏—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
   - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ production

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ê–Ω–∞–ª–∏–∑ –≤—ã—è–≤–∏–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã—Ö —É–∑–∫–∏—Ö –º–µ—Å—Ç –≤ factory-–ø—É—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–º—É —É–ª—É—á—à–µ–Ω–∏—é
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ç—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º
use case —Å–∏—Å—Ç–µ–º—ã.

